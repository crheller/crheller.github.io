<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-XDX3RFLYFH"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XDX3RFLYFH");</script> <meta name="google-site-verification" content=""> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Decoding-based dimensionality reduction (dDR) | Charles Heller </title> <meta name="author" content="Charles Heller"> <meta name="description" content="dDR is a supervised dimensionality reduction method that we developed during my PhD to perform robust decoding analysis from finite data samples."> <meta name="keywords" content="neuroscience, data science, max planck institute"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://crheller.github.io/projects/1_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Charles</span> Heller </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Decoding-based dimensionality reduction (dDR)</h1> <p class="post-description">dDR is a supervised dimensionality reduction method that we developed during my PhD to perform robust decoding analysis from finite data samples.</p> </header> <article> <h2 id="background">Background</h2> <p>One very common approach in systems neuroscience is decoding analysis. As researchers, we often ask: given neural activity alone, can we <em>decode</em> what the experimental condition was at any given time. The goal of this approach is typically to assign a functional label to a given neuron, group of neurons, or region of the brain. That is, if we observe that the activity of neurons in a particular region is informative about the visual environment, we can assign a “visual” label to this region. Over the years, this approach has helped researchers map out functional properties of a wide swath of brain regions.</p> <p>Importantly, however, most decoding methods assume that both the first-order (mean) and second-order (variance) statistics of the data can be estimated reliably. In practice, this is not always a safe assumption, particularly today. Thanks to advances in neural recording technologies, the dimensionality of neural datasets is rapidly increasing while experimental and behavioral constraints continue to limit the amount of data (observations) that can be collected in an experiment. As a result, second-order statistics, like the activity correlations between pairs of neurons, cannot be estimated reliably in most datasets.</p> <p>As a part of my PhD, I worked on developing a new, simple dimensionality reduction method which takes advantage of low-dimensional structure in neural population data to enable reliable estimation of decoding accuracy. This project was carried out under the supervision of my PhD advisor, Dr. Stephen David. Here, I will give a high level overview of the project targeted at a general, data science audience familiar with linear algebra - I will illustrate the problem, how we solved it, and demonstrate its application using example neural data. For a more in-depth, technical discussion of the method and its applications, please refer to our full <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0271136" rel="external nofollow noopener" target="_blank">manuscript</a>.</p> <p>If you are interested in trying the method with your own data, instructions for downloading the <code class="language-plaintext highlighter-rouge">dDR</code> package are available at: <a href="https://github.com/crheller/dDR" rel="external nofollow noopener" target="_blank">https://github.com/crheller/dDR</a>. A demo notebook is also included in this repository which demonstrates the standard use of the method. It also contains two example extensions of the method, which are discussed in our manuscript.</p> <h2 id="outline">Outline</h2> <ol> <li><a href="#decoding">What is decoding?</a></li> <li><a href="#motivation">Motivation for dDR</a></li> <li><a href="#ddrmethod">dDR</a></li> <li><a href="#appreal">Application to neural data</a></li> </ol> <h2 id="what-is-decoding"> <a name="decoding"></a>What is decoding?</h2> <p>Decoding analysis determines how well different conditions can be discriminated on the basis of the data collected in each respective condition. To make this explanation more concrete, I will continue to focus on neuroscience data here, but keep in mind that this idea can be extended to many types of data. In a typical systems neuroscience experiment, we record brain activity from subjects while presenting sensory stimuli to study how the brain represents this information, transforms it, and uses it to guide behavior.</p> <p>Let’s consider a simple experiment. Imagine that we want to know how the brain distinguishes between two different sounds - a car engine and a lawn mower. To study this, we measure the brain activity from a subject across many repeated presentations of each of these sounds. We call these presentations “trials.”</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ddr/popMats-480.webp 480w,/assets/img/ddr/popMats-800.webp 800w,/assets/img/ddr/popMats-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/ddr/popMats.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="fakedata" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Example of simulated neural activity in response to the subject hearing the sound of a car (left) or the sound of a lawn mower (right). Red means more activity, blue means less activity. </div> <p>The goal of decoding is to use the neural activity shown above to determine which dimenions of the neural activity are most informative about the sound identity. The most simple way to do this is by computing the difference in the mean activity across trials between conditions.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ddr/u_popMats-480.webp 480w,/assets/img/ddr/u_popMats-800.webp 800w,/assets/img/ddr/u_popMats-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/ddr/u_popMats.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="ufake" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Example computation of decoding axis based on the mean activty in each stimulus condition. From this we can see that some neurons (e.g., neurons 8 and 9 are very informative while others (e.g., neuron 1) are less informative). </div> <p>The difference in mean activity between conditions can be thought of as a “decoding axis” (\(\Delta\mu\)). Geometrically, this is the axis in the state-space of neural activity along which the mean neural activity is most different between car and lawn mower. We can visualize this by projecting the single-trial neural activities (\(X_{car}\) and \(X_{mower}\)) onto this axis:</p> \[r_{car} = X_{car}\Delta\mu^{T}\] \[r_{mower} = X_{mower}\Delta\mu^{T}\] <p>and plotting the resulting distributions for each sound:</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-0 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ddr/proj_popMats-480.webp 480w,/assets/img/ddr/proj_popMats-800.webp 800w,/assets/img/ddr/proj_popMats-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/ddr/proj_popMats.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="projfake" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Projection of single trial activity onto the measured decoding axis. </div> <p>As we can see, in this one dimensional readout of the neural activity the car and mower distributions are fairly well separated. As a final step, we can quantify the decoding performance. For example, one method for quantification would be to draw a “decision boundary,” as shown above, and determine the percentage of trials on which the sound identify was correctly identified based on the neural activity. In the following sections, however, I will use a metric called \(d'\), based on <a href="https://en.wikipedia.org/wiki/Detection_theory" rel="external nofollow noopener" target="_blank">signal detection theory</a>, which can be thought of as the z-scored difference in the response to the two stimuli:</p> \[d' = \| z[r_{car}] - z[r_{mower}] \|\] <h2 id="motivation-for-ddr"> <a name="motivation"></a>Motivation for dDR</h2> <p>The method for decoding presented above depends only on the first-order statistics of the data - that is, only on the mean acitivty of each neuron in each condition. In some cases, however, this is not the optimal solution. Often, we can do a bit better than this if we consider not just the mean activity, but also the correlations between pairs of neurons. This is the approach taken by methods such as <a href="https://en.wikipedia.org/wiki/Linear_discriminant_analysis" rel="external nofollow noopener" target="_blank">Linear Discriminant Analysis (LDA)</a>. To illustrate this idea, it is simpler to work with a two-dimensional dataset.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ddr/noisecorr-480.webp 480w,/assets/img/ddr/noisecorr-800.webp 800w,/assets/img/ddr/noisecorr-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/ddr/noisecorr.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="rsc" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Each color represents a stimulus condition (a vs. b). Ellipses represent the variance in the responses of neuron 1 and neuron 2 across trials. The optimal decoding axis solution depends not only on the difference in the mean activity between two conditions, but also on the trial-trial covariance between pairs of neurons. </div> <p>The example above illustrates that only under very special conditions (correlated activity either perfectly aligned with or perfectly orthogonal to \(\Delta\mu\)) is \(\Delta \mu\) the optimal linear decoding axis. Whenever this is not true, some benefit can be gained from factoring in correlations to the computation of the decoding axis, and a method such as LDA is preferred.</p> <p>In practice, however, it is not so simple. Second-order statistics (correlations) require much more data to estimate accurately. Therefore, with limited data, estimates of neural covariance can often be innacurate. This can then lead to extreme overfitting and poor performance on heldout validation data when applying methods like LDA, as illustrated with the simulation below.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-0 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ddr/fig2_selection-480.webp 480w,/assets/img/ddr/fig2_selection-800.webp 800w,/assets/img/ddr/fig2_selection-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/ddr/fig2_selection.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="tlc" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Top: Simulated response of two neurons across k=10 trials (left) or k=100 trials (right). The same underlying covariance was used in both cases. Bottom: Distribution of covariance after randomly shuffling trials between neuron 1 and neuron 2 to break all correlation. The true covariance value is well within the noise for k=10, illustrating that it cannot be estimated reliably from a sample of 10 trials. However, for k=100 trials we begin to be able to reliably measure the covariance between the pair of neurons. </div> <p>In most neuroscience experiments, we operate in the regime where we have too few trials to reliably estimate covariance (i.e., reality is closest to panel a, in the figure above). Thus, if we wish to apply optimal linear decoding techniques, like LDA, we need to develop new analytical approaches to first transform our data into a format that is suitable.</p> <h2 id="ddr"> <a name="ddrmethod"></a>dDR</h2> <p>dDR takes advantage of the observation that covariance patterns in neural activity are typically low-dimensional. That is, if you were to perform <a href="https://en.wikipedia.org/wiki/Principal_component_analysis" rel="external nofollow noopener" target="_blank">PCA</a> on a typical neural dataset, you would likely find that it has a relatively small number of significant dimensions. In other words, the covariance matrix can be described using only a handful of eigenvectors (\(e\)). Unlike single pairwise covariance coefficients, these high-variance eigenvectors can be estimated reliably even from very few trials, as demonstrated in the simulation below.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-0 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ddr/fig3_selection-480.webp 480w,/assets/img/ddr/fig3_selection-800.webp 800w,/assets/img/ddr/fig3_selection-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/ddr/fig3_selection.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="projfake" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Scree plot for 3 simulated datasets - One with low dimensionality (1-D), one with covariance that decays according to power law (1/n), and one where the variance of each neuron is independent (indep.). Right: Quality of the first principal component estimate as a function of number of trials. </div> <p>Thus, the first principal component of trial-trial covariance and the respective mean of neural activity under each condition define a unique hyperplane in the neural activity state space which can 1. Be estimated robustly and 2. Captures the two key features of population activity required for optimal linear decoding analysis. We call the projection into this space dDR. The full procedure is sketched out graphically below:</p> <div class="row justify-content-sm-center"> <div class="col-sm-16 mt-0 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ddr/ddr_schematic-480.webp 480w,/assets/img/ddr/ddr_schematic-800.webp 800w,/assets/img/ddr/ddr_schematic-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/ddr/ddr_schematic.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="projfake" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Schematic of the stepwise procedure for projecting high-dimensional data into the dDR space. </div> <p>Once projected into the dDR space, we can perform our optimal linear decoding analysis of choice without as much concern about overfitting to noisy estimates of pairwise covariance. Thus, dDR can be viewed as a sort of regularization to be performed prior to estimating decoding accuracy. In the next two sections, we briefly highlight dDR’s application to simulated and real data.</p> <h2 id="application-to-neural-data"> <a name="appreal"></a>Application to neural data</h2> <p>The sensitivity of decoding methods to overfitting is a known problem in neural data analysis. This is commonly dealt with by either using the \(\Delta \mu\) decoding approach discussed in <a href="#decoding">section 1</a> or to reduce the dimensionality of the data using principal component analysis. While each of these approaches are valid, they often result in finding non-optimal solutions. To illustrate this, we applied all three methods (\(\Delta\mu\), PCA, and dDR) to the same dataset and compared their cross-validated decoding performance as a function of number of trials.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-0 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ddr/fig6_selection-480.webp 480w,/assets/img/ddr/fig6_selection-800.webp 800w,/assets/img/ddr/fig6_selection-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/ddr/fig6_selection.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="projfake" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Neural activity was recorded from 52 neurons in auditory cortex while subjects listened to 50 repeats of 4 different auditory stimuli. Decoding performance for stimulus 1 vs. stimulus 2 (top) and stimulus 3 vs. stimulus 4 (bottom) is shown here. Left panels show the projection of 52-dimensional data into the 2-dimensional dDR space. Decoding performance (right) was measured as a function of trial count and was normalized to dDR performance. Stimulus repetitions were subsampled to show how decoding performance changes as a function of the number of trials. </div> <p>In all cases, we found that dDR performed as well as, or better than, both \(\Delta \mu\) and PCA approaches. We found that dDR was particulary beneficial in cases where 1. The two stimuli evoked similar mean activity in the neurons and 2. When the principal axis of covariance was not perfectly aligned with, or orthogonal to, the \(\Delta \mu\) axis, as discussed in <a href="#motivation">section 2</a>.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Charles Heller. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-XDX3RFLYFH"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XDX3RFLYFH");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script src="/assets/js/shortcut-key.js"></script> </body> </html>